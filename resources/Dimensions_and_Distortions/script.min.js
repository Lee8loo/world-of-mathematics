/* (c) 2016 Mathigon */
scripts.Dimensions_and_Distortions=function(){scripts.require("scripts/jsx-098.js",function(){var hyplines=0,pointsA=[],pointsB=[],pointsC=[],pointsP=[],arcs=[],x1=0,getMouseCoords=function(e){var cPos=board.getCoordsTopLeftCorner(e),absPos=JXG.getPosition(e),dx=absPos[0]-cPos[0],dy=absPos[1]-cPos[1];return new JXG.Coords(JXG.COORDS_BY_SCREEN,[dx,dy],board)},up=function(e){var el,coords=getMouseCoords(e);if(!(Math.pow(coords.usrCoords[1],2)+Math.pow(coords.usrCoords[2],2)>1)){for(el in board.objects)if(JXG.isPoint(board.objects[el])&&board.objects[el].hasPoint(coords.scrCoords[1],coords.scrCoords[2]))return;if(hyplines){var x=x1;pointsB[x]=board.create("point",[coords.usrCoords[1],coords.usrCoords[2]],{name:"",fillColor:"#D90000",strokeColor:"#D90000"}),pointsC[x]=board.create("point",[function(){return pointsA[x].X()/(pointsA[x].X()*pointsA[x].X()+pointsA[x].Y()*pointsA[x].Y())},function(){return pointsA[x].Y()/(pointsA[x].X()*pointsA[x].X()+pointsA[x].Y()*pointsA[x].Y())}],{visible:!1}),pointsP[x]=board.create("circumcirclemidpoint",[pointsA[x],pointsB[x],pointsC[x]],{visible:!1}),arcs[x]=board.create("minorarc",[pointsP[x],pointsB[x],pointsA[x]],{strokeColor:"#D90000",strokeWidth:2}),hyplines=0,x1++}else{var x=x1;pointsA[x]=board.create("point",[coords.usrCoords[1],coords.usrCoords[2]],{name:"",fillColor:"#D90000",strokeColor:"#D90000"}),hyplines=1}}},board=JXG.JSXGraph.initBoard("hyperbox",{boundingbox:[-1.05,1.05,1.05,-1.05],axis:!0,keepaspectratio:!0,axis:!1,grid:!1,showNavigation:!1,showCopyright:!1});board.create("circle",[[0,0],1],{strokeColor:"#006DD9",highlightStrokeOpacity:1,highlightFillOpacity:1});browser.isMobile?board.on("touchend",up):board.on("up",up)}),$("#hypbg").change(function(){0==$("#hypbg").val()?$("#hyperboxoverlay").css("background-image","none"):1==$("#hypbg").val()?$("#hyperboxoverlay").css("background-image","url(resources/Dimensions_and_Distortions/tiling"+browser.imgExt+".png)"):$("#hyperboxoverlay").css("background-image","url(resources/Dimensions_and_Distortions/escher"+browser.imgExt+".jpg)")}),scripts.require("resources/Conic_Sections/keyframes.js",function(){for($.keyframe.browserCode(),i=1;i<=10;i++)$.fn.addKeyframe([{name:"letters"+i,"0%":"background-position:      0 -"+100*(i-1)+"%","9%":"background-position:  -100% -"+100*(i-1)+"%","18%":"background-position:  -200% -"+100*(i-1)+"%","27%":"background-position:  -300% -"+100*(i-1)+"%","36%":"background-position:  -400% -"+100*(i-1)+"%","45%":"background-position:  -500% -"+100*(i-1)+"%","54%":"background-position:  -600% -"+100*(i-1)+"%","63%":"background-position:  -700% -"+100*(i-1)+"%","72%":"background-position:  -800% -"+100*(i-1)+"%","81%":"background-position:  -900% -"+100*(i-1)+"%","90%":"background-position: -1000% -"+100*(i-1)+"%","100%":"background-position: -1100% -"+100*(i-1)+"%"}]),$("#LetterBox"+i).attr("data-num",i),$("#LetterBox"+i).click(function(){var n=Number($(this).attr("data-num"));n&&($(this).attr("data-num","0"),$("#LetterBox"+n+" .AnimationBar").addClass("off"),$("#Letter"+n).css({animation:"letters"+n+" .8s step-start","animation-delay":".1s"}),setTimeout(function(){$("#Letter"+n).css("background-position","-1100% -"+100*(n-1)+"%")},200),$("#Letter"+n).css("AnimationPlayState","running"))})})};