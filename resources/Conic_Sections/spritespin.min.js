/* (c) 2016 Mathigon */
!function(){var Loader=this.SpriteLoader={};Loader.preload=function(images,callback){"string"==typeof images&&(images=[images]);var i,data={callback:callback,numLoaded:0,numImages:images.length,images:[]};for(i=0;i<images.length;i+=1)Loader.load(images[i],data)},Loader.load=function(imageSource,data){var image=new Image;data.images.push(image),image.onload=function(){data.numLoaded+=1,data.numLoaded===data.numImages&&data.callback(data.images)},image.src=imageSource}}(),function($,window){var Spin=window.SpriteSpin={},api=Spin.api={};Spin.modules={},Spin.behaviors={},Spin.disableSelection=function(e){return e.attr("unselectable","on").css({"-moz-user-select":"none","-khtml-user-select":"none","-webkit-user-select":"none","user-select":"none"}).on("selectstart",!1),e},Spin.updateInput=function(e,data){return void 0===e.touches&&void 0!==e.originalEvent&&(e.touches=e.originalEvent.touches),data.oldX=data.currentX,data.oldY=data.currentY,void 0!==e.touches&&e.touches.length>0?(data.currentX=e.touches[0].clientX,data.currentY=e.touches[0].clientY):(data.currentX=e.clientX,data.currentY=e.clientY),(void 0===data.startX||void 0===data.startY)&&(data.startX=data.currentX,data.startY=data.currentY,data.clickframe=data.frame),(void 0===data.oldX||void 0===data.oldY)&&(data.oldX=data.currentX,data.oldY=data.currentY),data.dX=data.currentX-data.startX,data.dY=data.currentY-data.startY,data.dW=data.dX*data.dragDirX+data.dY*data.dragDirY,data.ddX=data.currentX-data.oldX,data.ddY=data.currentY-data.oldY,data.ddW=data.ddX*data.dragDirX+data.ddY*data.dragDirY,!1},Spin.resetInput=function(data){data.startX=void 0,data.startY=void 0,data.currentX=void 0,data.currentY=void 0,data.oldX=void 0,data.oldY=void 0,data.dX=0,data.dY=0,data.dW=0,data.ddX=0,data.ddY=0,data.ddW=0,"function"==typeof data.module.resetInput&&data.module.resetInput(data)},Spin.clamp=function(value,min,max){return value>max?max:min>value?min:value},Spin.wrap=function(value,min,max,size){for(;value>max;)value-=size;for(;min>value;)value+=size;return value},Spin.reload=function(data,andInit){andInit&&data.module.initialize&&data.module.initialize(data),Spin.prepareBackground(data),Spin.preloadImages(data,function(){Spin.rebindEvents(data),data.module.reload(data),data.target.trigger("onLoad",data)})},Spin.preloadImages=function(data,callback){data.preload.fadeIn(250,function(){SpriteLoader.preload(data.source,function(images){data.preload.fadeOut(250,function(){data.preload.hide()}),data.stage.show(),data.canvas&&data.canvas.show(),data.images=images,callback.apply(data.target,[data])})})},Spin.prepareBackground=function(data){var w=[data.width,"px"].join(""),h=[data.height,"px"].join("");data.target.css({width:w,height:h,position:"relative"});var css={width:w,height:h,top:"0px",left:"0px",position:"absolute"};$.extend(css,data.preloadCSS||{}),data.preload.css(css).html(data.preloadHtml||"").hide(),data.stage.css({width:w,height:h,top:"0px",left:"0px",position:"absolute"}).hide(),data.canvas&&(data.canvas[0].width=data.width,data.canvas[0].height=data.height,data.canvas.css({width:w,height:h,top:"0px",left:"0px",position:"absolute"}).hide())},Spin.draw=function(data){data.module.draw(data)},Spin.rebindEvents=function(data){var target=data.target;target.unbind(".spritespin");var beh=data.behavior;"string"==typeof data.behavior&&(beh=Spin.behaviors[data.behavior]),beh=beh||{};var prevent=function(e){return e.cancelable&&e.preventDefault(),!1};target.bind("mousedown.spritespin",beh.mousedown||$.noop),target.bind("mousemove.spritespin",beh.mousemove||$.noop),target.bind("mouseup.spritespin",beh.mouseup||$.noop),target.bind("mouseenter.spritespin",beh.mouseenter||$.noop),target.bind("mouseover.spritespin",beh.mouseover||$.noop),target.bind("mouseleave.spritespin",beh.mouseleave||$.noop),target.bind("dblclick.spritespin",beh.dblclick||$.noop),target.bind("onFrame.spritespin",beh.onFrame||$.noop),data.touchable&&(target.bind("touchstart.spritespin",beh.mousedown||$.noop),target.bind("touchmove.spritespin",beh.mousemove||$.noop),target.bind("touchend.spritespin",beh.mouseup||$.noop),target.bind("touchcancel.spritespin",beh.mouseleave||$.noop),target.bind("click.spritespin",prevent),target.bind("gesturestart.spritespin",prevent),target.bind("gesturechange.spritespin",prevent),target.bind("gestureend.spritespin",prevent)),target.bind("mousedown.spritespin selectstart.spritespin",prevent),target.bind("onFrame.spritespin",function(event,data){Spin.draw(data)}),target.bind("onLoad.spritespin",function(event,data){data.target.spritespin("animate",data.animate,data.loop)}),"function"==typeof data.onFrame&&target.bind("onFrame.spritespin",data.onFrame),"function"==typeof data.onLoad&&target.bind("onLoad.spritespin",data.onLoad)},$.fn.spritespin=function(method){return api[method]?api[method].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof method&&method?void $.error("Method "+method+" does not exist on jQuery.spritespin"):api.init.apply(this,arguments)},api.init=function(options){var settings={width:void 0,height:void 0,frames:36,frame:0,module:"360",behavior:"drag",animate:!0,loop:!1,loopFrame:0,frameStep:1,frameTime:36,frameWrap:!0,reverse:!1,sense:1,orientation:"horizontal",source:void 0,preloadHtml:void 0,preloadCSS:void 0,onFrame:void 0,onLoad:void 0,touchable:void 0};return options=options||{},$.extend(settings,options),this.each(function(){var $this=$(this),data=$this.data("spritespin");if(data)$.extend(data,options),options.source?SpriteSpin.reload(data):$this.spritespin("animate",data.animate,data.loop);else{var images=$this.find("img"),i=0;if(images.length>0)for(settings.source=[],i=0;i<images.length;i+=1)settings.source.push($(images[i]).attr("src"));if("string"==typeof settings.source&&(settings.source=[settings.source]),Spin.disableSelection($this).css({overflow:"hidden",position:"relative"}),$this.empty(),$this.append($("<div class='spritespin-stage'/>")),$this.append($("<div class='spritespin-preload'/>")),$this.addClass("spritespin-instance"),settings.enableCanvas){var canvas=$("<canvas class='spritespin-canvas'/>")[0],supported=!(!canvas.getContext||!canvas.getContext("2d"));supported&&(settings.canvas=$(canvas),settings.context=canvas.getContext("2d"),$this.append(settings.canvas))}"string"==typeof settings.module&&(settings.module=SpriteSpin.modules[settings.module]),settings.target=$this,settings.stage=$this.find(".spritespin-stage"),settings.preload=$this.find(".spritespin-preload"),settings.animation=null,settings.touchable=settings.touchable||/iphone|ipod|ipad|android/i.test(window.navigator.userAgent),$this.data("spritespin",settings),SpriteSpin.reload(settings,!0)}})},api.destroy=function(){return this.each(function(){var $this=$(this);$this.unbind(".spritespin"),$this.removeData("spritespin")})},api.update=function(frame){return this.each(function(){var $this=$(this),data=$this.data("spritespin");void 0===frame?data.frame+=data.animation&&data.reverse?-data.frameStep:data.frameStep:data.frame=frame,data.animation||!data.animation&&data.frameWrap?data.frame=Spin.wrap(data.frame,0,data.frames-1,data.frames):data.frame=Spin.clamp(data.frame,0,data.frames-1),!data.loop&&data.animation&&data.frame===data.loopFrame&&api.animate.apply(data.target,[!1]),data.target.trigger("onFrame",data)})},api.animate=function(animate,loop){return void 0===animate?null!==$(this).data("spritespin").animation:this.each(function(){var $this=$(this),data=$this.data("spritespin");"boolean"==typeof loop&&(data.loop=loop),"toggle"===animate&&(data.animate=!data.animate),"boolean"==typeof animate&&(data.animate=animate),data.animation&&(window.clearInterval(data.animation),data.animation=null),data.animate&&(data.animation=window.setInterval(function(){try{$this.spritespin("update")}catch(err){}},data.frameTime))})},api.frame=function(frame){return void 0===frame?$(this).data("spritespin").frame:this.each(function(){$(this).spritespin("update",frame)})},api.loop=function(value){return void 0===value?$(this).data("spritespin").loop:this.each(function(){var $this=$(this);$this.spritespin("animate",$this.data("spritespin").animate,value)})},api.next=function(){return this.each(function(){var $this=$(this);$this.spritespin("frame",$this.spritespin("frame")+1)})},api.prev=function(){return this.each(function(){var $this=$(this);$this.spritespin("frame",$this.spritespin("frame")-1)})},api.animateTo=function(frame){return this.each(function(){var $this=$(this);$this.spritespin({animate:!0,loop:!1,loopFrame:frame})})},Spin.behaviors.none={name:"none",mousedown:$.noop,mousemove:$.noop,mouseup:$.noop,mouseenter:$.noop,mouseover:$.noop,mouseleave:$.noop,dblclick:$.noop,onFrame:$.noop}}(jQuery,window),function($,window,Spin){Spin.behaviors.click={name:"click",mouseup:function(e){var $this=$(this),data=$this.data("spritespin");Spin.updateInput(e,data),$this.spritespin("animate",!1);var h,p,o=data.target.offset();"horizontal"==data.orientation?(h=data.width/2,p=data.currentX-o.left):(h=data.height/2,p=data.currentY-o.top),p>h?($this.spritespin("frame",data.frame+1),data.reverse=!1):($this.spritespin("frame",data.frame-1),data.reverse=!0)}}}(jQuery,window,window.SpriteSpin),function($,window,Spin){Spin.behaviors.drag={name:"drag",mousedown:function(e){var $this=$(this),data=$this.data("spritespin");Spin.updateInput(e,data),data.onDrag=!0},mousemove:function(e){var $this=$(this),data=$this.data("spritespin");if(data.onDrag){Spin.updateInput(e,data);var d;d="horizontal"==data.orientation?data.dX/data.width:data.dY/data.height;var dFrame=d*data.frames*data.sense,frame=Math.round(data.clickframe+dFrame);$this.spritespin("update",frame),$this.spritespin("animate",!1)}},mouseup:function(e){var $this=$(this),data=$this.data("spritespin");Spin.resetInput(data),data.onDrag=!1},mouseleave:function(e){var $this=$(this),data=$this.data("spritespin");Spin.resetInput(data),data.onDrag=!1}}}(jQuery,window,window.SpriteSpin),function($,window,Spin){Spin.behaviors.hold={name:"hold",mousedown:function(e){var $this=$(this),data=$this.data("spritespin");Spin.updateInput(e,data),data.onDrag=!0,$this.spritespin("animate",!0)},mousemove:function(e){var $this=$(this),data=$this.data("spritespin");if(data.onDrag){Spin.updateInput(e,data);var h,d,o=data.target.offset();"horizontal"==data.orientation?(h=data.width/2,d=(data.currentX-o.left-h)/h):(h=data.height/2,d=(data.currentY-o.top-h)/h),data.reverse=0>d,d=0>d?-d:d,data.frameTime=80*(1-d)+20}},mouseup:function(e){var $this=$(this),data=$this.data("spritespin");Spin.resetInput(data),data.onDrag=!1,$this.spritespin("animate",!1)},mouseleave:function(e){var $this=$(this),data=$this.data("spritespin");Spin.resetInput(data),data.onDrag=!1,$this.spritespin("animate",!1)},onFrame:function(e){var $this=$(this);$this.spritespin("animate",!0)}}}(jQuery,window,window.SpriteSpin),function($,window,Spin){Spin.behaviors.swipe={name:"swipe",mousedown:function(e){var $this=$(this),data=$this.data("spritespin");Spin.updateInput(e,data),data.onDrag=!0},mousemove:function(e){var $this=$(this),data=$this.data("spritespin");if(data.onDrag){Spin.updateInput(e,data);var d,s,frame=data.frame,snap=data.snap||.25;"horizontal"==data.orientation?(d=data.dX,s=data.width*snap):(d=data.dY,s=data.height*snap),d>s?(frame=data.frame-1,data.onDrag=!1):-s>d&&(frame=data.frame+1,data.onDrag=!1),$this.spritespin("update",frame),$this.spritespin("animate",!1)}},mouseup:function(e){var $this=$(this),data=$this.data("spritespin");data.onDrag=!1,Spin.resetInput(data)},mouseleave:function(e){var $this=$(this),data=$this.data("spritespin");data.onDrag=!1,Spin.resetInput(data)}}}(jQuery,window,window.SpriteSpin),function($,window){var Module=window.SpriteSpin.modules[360]={};Module.reload=function(data){var images=$(data.images);data.stage.empty(),data.modopts={is_sprite:1==data.images.length,resX:data.resolutionX||data.images[0].width,resY:data.resolutionY||data.images[0].height,offX:data.offsetX||0,offY:data.offsetY||0,stepX:data.stepX||data.width,stepY:data.stepY||data.height,numFramesX:data.framesX||data.frames,oldFrame:data.frame,images:images},data.modopts.is_sprite||data.canvas||data.stage.append(images),images.css({width:"100%",height:"100%"}),Module.draw(data)},Module.draw=function(data){data.modopts.is_sprite?Module.drawSpritesheet(data):Module.drawImages(data)},Module.drawSpritesheet=function(data){var opts=data.modopts,image=data.source[0],frameX=data.frame%opts.numFramesX,frameY=data.frame/opts.numFramesX|0,x=opts.offX+frameX*opts.stepX,y=opts.offY+frameY*opts.stepY;return data.canvas?(data.context.clearRect(0,0,data.width,data.height),void data.context.drawImage(data.images[0],x,y,data.width,data.height,0,0,data.width,data.height)):void data.stage.css({width:"100%",height:"100%","background-image":["url('",image,"')"].join(""),"background-repeat":"no-repeat","background-position":[-x,"px ",-y,"px"].join(""),"-webkit-background-size":[opts.resX,"px ",opts.resY,"px"].join("")})},Module.drawImages=function(data){var img=data.images[data.frame];if(data.canvas)return data.context.clearRect(0,0,data.width,data.height),void data.context.drawImage(img,0,0);var frame=data.stage.css({width:"100%",height:"100%"}).children().hide()[data.frame];SpriteSpin.disableSelection($(frame)).show()}}(window.jQuery,window),function($,window){var Module=window.SpriteSpin.modules.gallery={};Module.reload=function(data){data.images=[],data.offsets=[],data.stage.empty(),data.speed=500,data.opacity=.25,data.oldFrame=0;var size=0,i=0;for(i=0;i<data.source.length;i+=1){var img=$("<img src='"+data.source[i]+"'/>");data.stage.append(img),data.images.push(img),data.offsets.push(-size+(data.width-img[0].width)/2),size+=img[0].width,img.css({opacity:.25})}data.images[data.oldFrame].animate({opacity:1},data.speed)},Module.draw=function(data){data.oldFrame!=data.frame&&data.offsets?(data.stage.stop(!0,!1),data.stage.animate({left:data.offsets[data.frame]},data.speed),data.images[data.oldFrame].animate({opacity:data.opacity},data.speed),data.oldFrame=data.frame,data.images[data.oldFrame].animate({opacity:1},data.speed)):data.stage.css({left:data.offsets[data.frame]+data.dX})},Module.resetInput=function(data){data.onDrag||data.stage.animate({left:data.offsets[data.frame]})}}(jQuery,window),function($,window){var Module=window.SpriteSpin.modules.panorama={};Module.reload=function(data){data.stage.empty();var opts=data.modopts={};opts.resX=data.resolutionX||data.images[0].width,opts.resY=data.resolutionY||data.images[0].height,"horizontal"==data.orientation?opts.frames=data.frames||opts.resX:opts.frames=data.frames||opts.resY,Module.draw(data)},Module.draw=function(data){var x,y,opts=data.modopts;"horizontal"==data.orientation?(x=data.frame%opts.frames,y=0):(x=0,y=data.frame%opts.frames),data.stage.css({width:[data.width,"px"].join(""),height:[data.height,"px"].join(""),"background-image":["url('",data.source[0],"')"].join(""),"background-repeat":"repeat-both","background-position":[-x,"px ",-y,"px"].join(""),"-webkit-background-size":[opts.resX,"px ",opts.resY,"px"].join("")})}}(window.jQuery,window);